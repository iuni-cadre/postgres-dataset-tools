-- This SQL script loads OpenAlex data from backwards
-- compatible MAG formatted data in CSV files.  The
-- CSV files are assumed to have been generated by the
-- 

\COPY oa_core.affiliations FROM '/raw/FilteredMAGData/openalex_2022/mag_affiliations.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER; 

\COPY oa_core.authors FROM '/raw/FilteredMAGData/openalex_2022/mag_authors.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.journals FROM '/raw/FilteredMAGData/openalex_2022/mag_journals.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.conference_series FROM '/raw/FilteredMAGData/openalex_2022/mag_conferenceSeries.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.fields_of_study FROM '/raw/FilteredMAGData/openalex_2022/mag_fieldsOfStudy.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.conference_instances FROM '/raw/FilteredMAGData/openalex_2022/mag_conferenceInstances.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.papers FROM '/raw/FilteredMAGData/openalex_2022/mag_papers.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.paper_resources FROM '/raw/FilteredMAGData/openalex_2022/mag_paperResources.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.related_field_of_study FROM '/raw/FilteredMAGData/openalex_2022/mag_relatedFieldOfStudy.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.paper_urls FROM '/raw/FilteredMAGData/openalex_2022/mag_paperURLs.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.paper_abstract_inverted_index FROM '/raw/FilteredMAGData/openalex_2022/mag_paperAbstractInvertedIndex.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.paper_author_affiliations FROM '/raw/FilteredMAGData/openalex_2022/mag_paperAuthorAffiliations.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

/* The paper citation contexts table has a problem with special characters or control characters. You may want to skip this table but you can try and see if it works for you */

\COPY oa_core.paper_citation_contexts FROM '/raw/FilteredMAGData/openalex_2022/mag_paperCitationContexts.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.paper_fields_of_study FROM '/raw/FilteredMAGData/openalex_2022/mag_paperFieldsOfStudy.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.paper_recommendations FROM '/raw/FilteredMAGData/openalex_2022/mag_paperRecommendations.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.paper_references FROM '/raw/FilteredMAGData/openalex_2022/mag_paperReferences.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;

\COPY oa_core.field_of_study_children FROM '/raw/FilteredMAGData/openalex_2022/mag_fieldsOfStudyChildren.csv' DELIMITER '~' ENCODING 'UTF-8' CSV HEADER;




/*
\COPY paper_citation_contexts FROM '/raw/mag-clean/PaperCitationContexts.txt' DELIMITER E'\t' ENCODING 'UTF-8' CSV HEADER;

*/
